#get vcf file
module add UHTS/Analysis/samtools/1.3;
wget http://hgdownload.cse.ucsc.edu/goldenPath/mm9/database/snp128.txt.gz
gunzip snp128.txt.gz
###Convert txt to VCF file
vcfutils.pl ucscsnp2vcf snp128_s.txt > snp128.vcf

#####GTAK way for vcf files:
module add UHTS/Analysis/GenomeAnalysisTK/3.7;
GenomeAnalysisTK.jar -T VariantsToVCF -R /db/SOFTWARE/bowtie2/mm9/genome.fa -o mm9_snp128.vcf --variant:mm9_snp128.txt


#####Create dictionary and index
module add UHTS/Analysis/picard-tools/1.80;
picard-tools CreateSequenceDictionary R= genome.fa O=genome.fa.dict
samtools faidx genome.fa 
######################## GTAK

module add UHTS/Analysis/GenomeAnalysisTK/3.7;

#Base Recalibrator

GenomeAnalysisTK  -T BaseRecalibrator -R genome.fa -I Bicc1KH1/Bicc1KH1_unique_hits_s.bam -L 21  -knownSites  snp128.vcf -o recal_data.table
#ERROR con el head del sam file?
picard-tools AddOrReplaceReadGroups I=Bicc1KH1/Bicc1KH1_unique_hits_s.bam O=Bicc1KH1/Bicc1KH1_unique_hits_2.bam RGSM=Bicc1KH1 RGLB=bicc1 RGPL=illumina RGPU=none
